var trackHQ,debug=!1,clientID,appUserID,pageLoadTime=Date.now(),jQuerySrcLocation="http://code.jquery.com/jquery-1.11.0.min.js",track={init:function(e,t,n){if(trackHQ=e,appUserID=t||null,debug=n||!1,clientID=this.getClientID(),this.logger("Set ClientID"),this.logger("TrackJS Loading..."),"undefined"==typeof jQuery){this.logger("Loading jQuery")
var o=document.createElement("script")
o.type="text/javascript",o.src=jQuerySrcLocation,document.getElementsByTagName("head")[0].appendChild(o),setTimeout(function(){track.attachEvents()},100)}},getClientID:function(){if(this.getCookie("TrackJS"))return this.getCookie("TrackJS")
var e=this.generateGUID()
return this.setCookie("TrackJS",e,365),e},attachEvents:function(){"undefined"==typeof jQuery?(this.logger("jQuery not loaded, waiting..."),setTimeout(function(){track.attachEvents()},500)):(this.logger("jQuery loaded"),this.logger("Attaching events"),$(document).ready(function(){track.sendEvent({event:"load"})}),$(window).on("beforeunload",function(){track.sendEvent({event:"unload"})}),$(document).on("click",function(e){track.sendEvent({event:"click",click:{x:e.pageX,y:e.pageY},scrolled:{x:$(document).scrollLeft(),y:$(document).scrollTop()}})}))},sendEvent:function(e){e._time=Date.now(),e._elapsed=e._time-pageLoadTime,e._url=document.URL,e._title=document.title,e._clientid=clientID,e._appUserID=appUserID
var t=document.createElement("img")
t.src=trackHQ+"?event="+btoa(JSON.stringify(e)),document.getElementsByTagName("body")[0].appendChild(t),this.logger(e)},logger:function(e){debug&&console.log("track.js: "+clientID+" : "+JSON.stringify(e))},generateGUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0
return("x"==e?t:3&t|8).toString(16)})},getCookie:function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie),o=n.split(";"),i=0;i<o.length;i++){for(var r=o[i];" "==r.charAt(0);)r=r.substring(1)
if(0==r.indexOf(t))return r.substring(t.length,r.length)}return!1},setCookie:function(e,t,n){var o=new Date
o.setTime(o.getTime()+24*n*60*60*1e3)
var i="expires="+o.toUTCString()
document.cookie=e+"="+t+";"+i+";path=/"}}
